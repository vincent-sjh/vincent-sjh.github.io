<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Ocaml(1) Vincent’s Technical Reports (Vol. 2)" /><meta name="author" content="宋建昊" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="Ocaml编程语言初探" /><meta property="og:description" content="Ocaml编程语言初探" /><link rel="canonical" href="https://vincent-sjh.github.io/homepage/index.html/posts/Ocaml-1/" /><meta property="og:url" content="https://vincent-sjh.github.io/homepage/index.html/posts/Ocaml-1/" /><meta property="og:site_name" content="宋建昊" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-07-03T16:30:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Ocaml(1) Vincent’s Technical Reports (Vol. 2)" /><meta name="twitter:site" content="@si57311" /><meta name="twitter:creator" content="@宋建昊" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"宋建昊"},"dateModified":"2025-08-12T08:47:35+00:00","datePublished":"2025-07-03T16:30:00+00:00","description":"Ocaml编程语言初探","headline":"Ocaml(1) Vincent’s Technical Reports (Vol. 2)","mainEntityOfPage":{"@type":"WebPage","@id":"https://vincent-sjh.github.io/homepage/index.html/posts/Ocaml-1/"},"url":"https://vincent-sjh.github.io/homepage/index.html/posts/Ocaml-1/"}</script><title>Ocaml(1) | Vincent's Technical Reports (Vol. 2) | 宋建昊</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="宋建昊"><meta name="application-name" content="宋建昊"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/config/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">宋建昊</a></div><div class="site-subtitle font-italic">We paint the world with our colors and everyone will know.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/vincent-sjh" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/si57311" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['songjh22','mails.tsinghua.edu.cn'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>Ocaml(1) | Vincent's Technical Reports (Vol. 2)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Ocaml(1) | Vincent's Technical Reports (Vol. 2)</h1><div class="post-meta text-muted"> <span> 发表于 <em class="" data-ts="1751560200" data-df="YYYY/MM/DD" data-toggle="tooltip" data-placement="bottom"> 2025/07/03 </em> </span> <span> 更新于 <em class="" data-ts="1754988455" data-df="YYYY/MM/DD" data-toggle="tooltip" data-placement="bottom"> 2025/08/12 </em> </span><div class="d-flex justify-content-between"> <span> 作者 <em> <a href=""></a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4263 字"> <em>23 分钟</em>阅读</span></div></div></div><div class="post-content"><h1 id="ocaml编程语言初探">Ocaml编程语言初探</h1><h2 id="简介"><span class="mr-2">简介</span><a href="#简介" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">OCaml</code> (<code class="language-plaintext highlighter-rouge">Objective Caml</code>)是一种功能强大、兼具函数式、命令式和面向对象编程特性的通用编程语言。它由 <code class="language-plaintext highlighter-rouge">INRIA</code>(法国国家信息与自动化研究所)开发，最初设计于 1980 年代，是 <code class="language-plaintext highlighter-rouge">Caml</code> (<code class="language-plaintext highlighter-rouge">Categorical Abstract Machine Language</code>)语言的扩展版本，而 <code class="language-plaintext highlighter-rouge">Caml</code> 是 <code class="language-plaintext highlighter-rouge">ML</code>(<code class="language-plaintext highlighter-rouge">Meta Language</code>)语言家族的一员。ML 语言起源于 1970 年代的 <code class="language-plaintext highlighter-rouge">Edinburgh LCF</code> 项目，旨在为形式化证明系统提供编程支持。<code class="language-plaintext highlighter-rouge">OCaml</code>专注于函数式编程，以其类型安全、性能高效和表达力强等特点，在学术研究、工业开发和教学领域广受欢迎。</p><h2 id="特性"><span class="mr-2">特性</span><a href="#特性" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="强静态类型系统"><span class="mr-2">强静态类型系统</span><a href="#强静态类型系统" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">OCaml</code>采用静态类型检查，无需显式声明类型，编译器通过类型推导自动推断变量类型。<li>类型系统非常严格，防止运行时类型错误。例如：<div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="n">add</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="c">(* 编译器推断类型为 int -&gt; int -&gt; int *)</span>
</pre></table></code></div></div><li>支持多态类型，如 <code class="language-plaintext highlighter-rouge">'a list</code> 表示任意类型的列表。</ul><h3 id="函数式编程"><span class="mr-2">函数式编程</span><a href="#函数式编程" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>函数是一等公民，支持高阶函数、闭包和递归。<li>强调不可变性(<code class="language-plaintext highlighter-rouge">immutability</code>)，默认情况下数据是不可变的，减少副作用。<li>强大的模式匹配(<code class="language-plaintext highlighter-rouge">pattern matching</code>)机制，用于处理复杂的数据结构。例如：<div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="k">rec</span> <span class="n">factorial</span> <span class="n">n</span> <span class="o">=</span> <span class="k">match</span> <span class="n">n</span> <span class="k">with</span>
  <span class="o">|</span> <span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">1</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div></ul><h3 id="命令式编程"><span class="mr-2">命令式编程</span><a href="#命令式编程" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>支持可变状态(如 <code class="language-plaintext highlighter-rouge">ref</code> 类型)和循环结构，允许命令式编程风格。<li>示例：使用可变引用计算累加和：<div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="n">sum_list</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">ref</span> <span class="mi">0</span> <span class="k">in</span>
  <span class="nn">List</span><span class="p">.</span><span class="n">iter</span> <span class="p">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">sum</span> <span class="o">:=</span> <span class="o">!</span><span class="n">sum</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="n">lst</span><span class="p">;</span>
  <span class="o">!</span><span class="n">sum</span>
</pre></table></code></div></div></ul><h3 id="面向对象编程"><span class="mr-2">面向对象编程</span><a href="#面向对象编程" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">OCaml</code> 支持类、对象、继承和多态，适合需要面向对象设计的场景。<li>示例：定义一个简单的类：<div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="n">point</span> <span class="n">x_init</span> <span class="n">y_init</span> <span class="o">=</span> <span class="k">object</span>
  <span class="k">val</span> <span class="k">mutable</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x_init</span>
  <span class="k">val</span> <span class="k">mutable</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_init</span>
  <span class="n">method</span> <span class="n">move</span> <span class="n">dx</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;-</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span>
  <span class="n">method</span> <span class="n">get_x</span> <span class="o">=</span> <span class="n">x</span>
  <span class="n">method</span> <span class="n">get_y</span> <span class="o">=</span> <span class="n">y</span>
<span class="k">end</span>
</pre></table></code></div></div></ul><h3 id="模块系统"><span class="mr-2">模块系统</span><a href="#模块系统" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">OCaml</code> 提供强大的模块系统，支持抽象数据类型和代码组织。<li>模块可以包含类型、值和函数，支持函子(<code class="language-plaintext highlighter-rouge">functor</code>)实现模块的泛型编程。<li>示例：定义一个简单模块：<div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">module</span> <span class="nc">IntSet</span> <span class="o">=</span> <span class="nn">Set</span><span class="p">.</span><span class="nc">Make</span><span class="p">(</span><span class="k">struct</span>
  <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">int</span>
  <span class="k">let</span> <span class="n">compare</span> <span class="o">=</span> <span class="n">compare</span>
<span class="k">end</span><span class="p">)</span>
</pre></table></code></div></div></ul><h3 id="高效性能"><span class="mr-2">高效性能</span><a href="#高效性能" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>OCaml 编译器生成高效的本机代码，性能接近 C/C++。<li>提供增量式垃圾回收(<code class="language-plaintext highlighter-rouge">Garbage Collection</code>)，优化内存管理。<li>支持直接调用 C 函数(通过外部接口)，便于与底层系统集成。</ul><h3 id="并发与并行支持"><span class="mr-2">并发与并行支持</span><a href="#并发与并行支持" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">OCaml</code> <code class="language-plaintext highlighter-rouge">5.x</code> 引入了多核 OCaml，支持并行计算，使用域(<code class="language-plaintext highlighter-rouge">domains</code>)和效果系统(<code class="language-plaintext highlighter-rouge">effect system</code>)处理并发。<li>提供了轻量级线程(如 <code class="language-plaintext highlighter-rouge">Lwt</code> 和 <code class="language-plaintext highlighter-rouge">Async</code> 库)用于异步编程。</ul><h3 id="异常处理"><span class="mr-2">异常处理</span><a href="#异常处理" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>支持异常机制，允许优雅地处理错误。<li>示例：<div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">try</span> <span class="nn">List</span><span class="p">.</span><span class="n">find</span> <span class="p">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">[</span><span class="mi">1</span><span class="p">;</span> <span class="mi">2</span><span class="p">;</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">with</span> <span class="nc">Not_found</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</pre></table></code></div></div></ul><h3 id="强大的工具生态"><span class="mr-2">强大的工具生态</span><a href="#强大的工具生态" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>编译器：OCaml 提供快速的原生代码编译器和字节码编译器。<li>包管理：使用 <code class="language-plaintext highlighter-rouge">opam</code>(<code class="language-plaintext highlighter-rouge">OCaml Package Manager</code>)管理库和依赖。<li>工具：支持 <code class="language-plaintext highlighter-rouge">dune</code>(构建工具)、<code class="language-plaintext highlighter-rouge">ocamlformat</code>(代码格式化)、<code class="language-plaintext highlighter-rouge">merlin</code>(<code class="language-plaintext highlighter-rouge">IDE</code> 支持)等。</ul><hr /><h2 id="安装"><span class="mr-2">安装</span><a href="#安装" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install </span>ocaml
<span class="nb">sudo </span>apt <span class="nb">install </span>utop
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">UTop</code> 是<code class="language-plaintext highlighter-rouge">Ocaml</code>的<code class="language-plaintext highlighter-rouge">REPL</code>(<code class="language-plaintext highlighter-rouge">read evaluate print loop</code>)，在<code class="language-plaintext highlighter-rouge">Ocaml</code>中也叫做<code class="language-plaintext highlighter-rouge">toplevel</code>。<li>输入表达式，可以看到对应的带有类型的输出，需要记得在每行后结尾加两个分号<code class="language-plaintext highlighter-rouge">;;</code>。<li>关闭<code class="language-plaintext highlighter-rouge">UTop</code>可以使用快捷键<code class="language-plaintext highlighter-rouge">ctrl+d</code>或者在<code class="language-plaintext highlighter-rouge">UTop</code>中执行<code class="language-plaintext highlighter-rouge">exit 0;;</code>。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 20:01:07 <span class="o">)</span>─&lt; <span class="nb">command </span>0 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># 1 + 2;;</span>
- : int <span class="o">=</span> 3
─<span class="o">(</span> 20:01:07 <span class="o">)</span>─&lt; <span class="nb">command </span>1 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># exit 0;;</span>
</pre></table></code></div></div><h2 id="语法与编程风格"><span class="mr-2">语法与编程风格</span><a href="#语法与编程风格" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>OCaml 的语法简洁优雅，结合了函数式和命令式的特点。</p><h3 id="基本类型与操作"><span class="mr-2">基本类型与操作</span><a href="#基本类型与操作" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>基本类型：<code class="language-plaintext highlighter-rouge">int</code>、<code class="language-plaintext highlighter-rouge">float</code>、<code class="language-plaintext highlighter-rouge">bool</code>、<code class="language-plaintext highlighter-rouge">string</code>、<code class="language-plaintext highlighter-rouge">char</code> 等。<li>列表：<code class="language-plaintext highlighter-rouge">[1; 2; 3]</code>，使用分号分隔元素。<li>元组：<code class="language-plaintext highlighter-rouge">(1, "hello")</code>，表示异构数据集合。</ul><h3 id="模式匹配"><span class="mr-2">模式匹配</span><a href="#模式匹配" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>模式匹配是 OCaml 的核心特性，用于解构数据和控制流。</p><div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="k">rec</span> <span class="n">length</span> <span class="n">lst</span> <span class="o">=</span> <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="n">_</span> <span class="o">::</span> <span class="n">tail</span> <span class="o">-&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">length</span> <span class="n">tail</span>
</pre></table></code></div></div><h3 id="高阶函数"><span class="mr-2">高阶函数</span><a href="#高阶函数" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>支持函数作为参数或返回值。</p><div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="n">apply_twice</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span> <span class="n">f</span> <span class="p">(</span><span class="n">f</span> <span class="n">x</span><span class="p">)</span>
<span class="k">let</span> <span class="n">square</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
<span class="k">let</span> <span class="n">result</span> <span class="o">=</span> <span class="n">apply_twice</span> <span class="n">square</span> <span class="mi">3</span> <span class="c">(* the result is 81 *)</span>
</pre></table></code></div></div><h3 id="模块与函子"><span class="mr-2">模块与函子</span><a href="#模块与函子" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>模块系统支持代码抽象和复用：</p><div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">module</span> <span class="k">type</span> <span class="nc">Comparable</span> <span class="o">=</span> <span class="k">sig</span>
  <span class="k">type</span> <span class="n">t</span>
  <span class="k">val</span> <span class="n">compare</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
<span class="k">end</span>

<span class="k">module</span> <span class="nc">SetMaker</span> <span class="p">(</span><span class="nc">C</span> <span class="o">:</span> <span class="nc">Comparable</span><span class="p">)</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="nn">C</span><span class="p">.</span><span class="n">t</span>
  <span class="k">let</span> <span class="n">compare</span> <span class="o">=</span> <span class="nn">C</span><span class="p">.</span><span class="n">compare</span>
<span class="k">end</span>
</pre></table></code></div></div><h3 id="详细介绍"><span class="mr-2">详细介绍</span><a href="#详细介绍" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>可以使用<code class="language-plaintext highlighter-rouge">let</code>定义变量，但Ocaml中的变量值是不可变的。<li><code class="language-plaintext highlighter-rouge">=</code>相当于C语言中的双等号<code class="language-plaintext highlighter-rouge">==</code>，代表判定等号两侧是否相等。<li>变量名必须以小写字母或者下划线开头。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 20:01:58 <span class="o">)</span>─&lt; <span class="nb">command </span>0 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let x = 50;;</span>
val x : int <span class="o">=</span> 50
─<span class="o">(</span> 20:01:58 <span class="o">)</span>─&lt; <span class="nb">command </span>1 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># x = 50;;</span>
- : bool <span class="o">=</span> <span class="nb">true</span>
─<span class="o">(</span> 20:03:28 <span class="o">)</span>─&lt; <span class="nb">command </span>2 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># x = 500;;</span>
- : bool <span class="o">=</span> <span class="nb">false</span>
</pre></table></code></div></div><ul><li>可以使用<code class="language-plaintext highlighter-rouge">let</code>+<code class="language-plaintext highlighter-rouge">in</code>的语法来计算函数值。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 20:03:54 <span class="o">)</span>─&lt; <span class="nb">command </span>3 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let x = 100 in x * (x - 1);;</span>
- : int <span class="o">=</span> 9900
─<span class="o">(</span> 20:15:07 <span class="o">)</span>─&lt; <span class="nb">command </span>4 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let x = 10 in let y = 100 in x * y;;</span>
- : int <span class="o">=</span> 1000
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">let</code>也可以用来定义一元函数甚至多元函数。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 20:17:51 <span class="o">)</span>─&lt; <span class="nb">command </span>5 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let square x = x * x;;</span>
val square : int -&gt; int <span class="o">=</span> &lt;fun&gt;
─<span class="o">(</span> 20:17:53 <span class="o">)</span>─&lt; <span class="nb">command </span>6 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let area = square 100;;</span>
val area : int <span class="o">=</span> 10000
─<span class="o">(</span> 20:18:18 <span class="o">)</span>─&lt; <span class="nb">command </span>7 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let multiply x y = x * y;;</span>
val multiply : int -&gt; int -&gt; int <span class="o">=</span> &lt;fun&gt;
</pre></table></code></div></div><ul><li>可以使用<code class="language-plaintext highlighter-rouge">let rec</code>来定义递归函数。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 20:18:33 <span class="o">)</span>─&lt; <span class="nb">command </span>8 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let rec range a b = if a &gt; b then [] else a :: range (a + 1) b;;</span>
val range : int -&gt; int -&gt; int list <span class="o">=</span> &lt;fun&gt;
─<span class="o">(</span> 20:20:21 <span class="o">)</span>─&lt; <span class="nb">command </span>9 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let digits = range 0 9;;</span>
val digits : int list <span class="o">=</span> <span class="o">[</span>0<span class="p">;</span> 1<span class="p">;</span> 2<span class="p">;</span> 3<span class="p">;</span> 4<span class="p">;</span> 5<span class="p">;</span> 6<span class="p">;</span> 7<span class="p">;</span> 8<span class="p">;</span> 9]
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">Ocaml</code>是强静态类型语言，运行前编译器会自动进行类型推断，基本类型和其他语言类似。<li><code class="language-plaintext highlighter-rouge">Ocaml</code>中禁止隐式的类型转换。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 20:23:53 <span class="o">)</span>─&lt; <span class="nb">command </span>10 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># 1 + 1;;</span>
- : int <span class="o">=</span> 2
─<span class="o">(</span> 20:25:08 <span class="o">)</span>─&lt; <span class="nb">command </span>11 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># 1.0 +. 1.0;;</span>
- : float <span class="o">=</span> 2.
─<span class="o">(</span> 20:25:17 <span class="o">)</span>─&lt; <span class="nb">command </span>12 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># false;;</span>
- : bool <span class="o">=</span> <span class="nb">false</span>
─<span class="o">(</span> 20:25:47 <span class="o">)</span>─&lt; <span class="nb">command </span>13 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># 's';;</span>
- : char <span class="o">=</span> <span class="s1">'s'</span>
─<span class="o">(</span> 20:26:22 <span class="o">)</span>─&lt; <span class="nb">command </span>14 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># "Vincent";;</span>
- : string <span class="o">=</span> <span class="s2">"Vincent"</span>
</pre></table></code></div></div><ul><li>可以使用模式匹配方便地处理各种情况，非常适合<code class="language-plaintext highlighter-rouge">corner case</code>很多的情况。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 20:27:51 <span class="o">)</span>─&lt; <span class="nb">command </span>15 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c">#  let rec factorial n =</span>
match n with
| 0 | 1 -&gt; 1
| _ -&gt; n <span class="k">*</span> factorial <span class="o">(</span>n - 1<span class="o">)</span><span class="p">;;</span>
val factorial : int -&gt; int <span class="o">=</span> &lt;fun&gt;
─<span class="o">(</span> 20:51:20 <span class="o">)</span>─&lt; <span class="nb">command </span>16 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># factorial 5;;</span>
- : int <span class="o">=</span> 120
</pre></table></code></div></div><ul><li>列表<code class="language-plaintext highlighter-rouge">list</code></ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 20:52:55 <span class="o">)</span>─&lt; <span class="nb">command </span>17 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># [];;</span>
- : <span class="s1">'a list = []
─( 20:53:12 )─&lt; command 18 &gt;──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # [1;1];;
- : int list = [1; 1]
─( 20:55:47 )─&lt; command 19 &gt;──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # [true;false];;
- : bool list = [true; false]
─( 20:55:47 )─&lt; command 20 &gt;──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────{ counter: 0 }─
utop # [[1;2];[1;2]];;
- : int list list = [[1;2];[1;2]]
</span></pre></table></code></div></div><ul><li>操作符有<code class="language-plaintext highlighter-rouge">::</code>(用来在列表前添加一个元素)和<code class="language-plaintext highlighter-rouge">@</code>(用来连接两个列表)。<li><code class="language-plaintext highlighter-rouge">List</code>的方法<code class="language-plaintext highlighter-rouge">hd</code>和<code class="language-plaintext highlighter-rouge">tl</code>可以分别获得列表头尾的元素。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 20:56:02 <span class="o">)</span>─&lt; <span class="nb">command </span>21 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># 1 :: [2;3];;</span>
- : int list <span class="o">=</span> <span class="o">[</span>1<span class="p">;</span> 2<span class="p">;</span> 3]
─<span class="o">(</span> 20:56:43 <span class="o">)</span>─&lt; <span class="nb">command </span>22 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># [1] @ [2;3];;</span>
- : int list <span class="o">=</span> <span class="o">[</span>1<span class="p">;</span> 2<span class="p">;</span> 3]
─<span class="o">(</span> 21:00:45 <span class="o">)</span>─&lt; <span class="nb">command </span>23 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># List.hd [1;2;3;4];;</span>
- : int <span class="o">=</span> 1
─<span class="o">(</span> 21:00:59 <span class="o">)</span>─&lt; <span class="nb">command </span>24 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># List.tl [1;2;3;4];;</span>
- : int list <span class="o">=</span> <span class="o">[</span>2<span class="p">;</span> 3<span class="p">;</span> 4]
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">partial application</code>特性，可以给一个多元函数部分参数得到另一个函数。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 15:27:40 <span class="o">)</span>─&lt; <span class="nb">command </span>1 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let add a b = a + b;;</span>
val add : int -&gt; int -&gt; int <span class="o">=</span> &lt;fun&gt;
─<span class="o">(</span> 15:30:09 <span class="o">)</span>─&lt; <span class="nb">command </span>2 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let add1 = add 1;;</span>
val add1 : int -&gt; int <span class="o">=</span> &lt;fun&gt;
─<span class="o">(</span> 15:30:14 <span class="o">)</span>─&lt; <span class="nb">command </span>3 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># add1 6;;</span>
- : int <span class="o">=</span> 7
</pre></table></code></div></div><ul><li>元组<code class="language-plaintext highlighter-rouge">tuple</code>，可以是不同类型数据的组合，之前的<code class="language-plaintext highlighter-rouge">list</code>必须是相同类型元素的组合。<li><code class="language-plaintext highlighter-rouge">tuple</code>不具备<code class="language-plaintext highlighter-rouge">list</code>可以改变长度的特性，<code class="language-plaintext highlighter-rouge">tuple</code>的长度是固定的。<li>自定义枚举类型，注意首字母必须大写。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 15:31:22 <span class="o">)</span>─&lt; <span class="nb">command </span>4 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let tup = (7,"vincent",100.00);;</span>
val tup : int <span class="k">*</span> string <span class="k">*</span> float <span class="o">=</span> <span class="o">(</span>7, <span class="s2">"vincent"</span>, 100.<span class="o">)</span>
─<span class="o">(</span> 15:44:27 <span class="o">)</span>─&lt; <span class="nb">command </span>14 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># type gender = Male | Female | Helicopter;;</span>
<span class="nb">type </span>gender <span class="o">=</span> Male | Female | Helicopter
─<span class="o">(</span> 15:44:34 <span class="o">)</span>─&lt; <span class="nb">command </span>15 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let l =[Male;Female;Helicopter];;</span>
val l : gender list <span class="o">=</span> <span class="o">[</span>Male<span class="p">;</span> Female<span class="p">;</span> Helicopter]
─<span class="o">(</span> 15:46:07 <span class="o">)</span>─&lt; <span class="nb">command </span>20 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># type gender = Male | Female | Helicopter | Mixture of int * int * int;;</span>
<span class="nb">type </span>gender <span class="o">=</span> Male | Female | Helicopter | Mixture of int <span class="k">*</span> int <span class="k">*</span> int
─<span class="o">(</span> 15:46:08 <span class="o">)</span>─&lt; <span class="nb">command </span>21 <span class="o">&gt;</span>───────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let l =[Male;Female;Helicopter;Mixture (1,2,6)];;</span>
val l : gender list <span class="o">=</span> <span class="o">[</span>Male<span class="p">;</span> Female<span class="p">;</span> Helicopter<span class="p">;</span> Mixture <span class="o">(</span>1, 2, 6<span class="o">)]</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">Record</code>类型。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 15:35:31 <span class="o">)</span>─&lt; <span class="nb">command </span>7 <span class="o">&gt;</span>────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># type person = {name:string;nickname:string;age:int;};;</span>
<span class="nb">type </span>person <span class="o">=</span> <span class="o">{</span> name : string<span class="p">;</span> nickname : string<span class="p">;</span> age : int<span class="p">;</span> <span class="o">}</span>
─<span class="o">(</span> 15:39:38 <span class="o">)</span>─&lt; <span class="nb">command </span>8 <span class="o">&gt;</span>────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let vincent = {name = "vincent";nickname="embracer";age=20;};;</span>
val vincent : person <span class="o">=</span> <span class="o">{</span>name <span class="o">=</span> <span class="s2">"vincent"</span><span class="p">;</span> nickname <span class="o">=</span> <span class="s2">"embracer"</span><span class="p">;</span> age <span class="o">=</span> 20<span class="o">}</span>
─<span class="o">(</span> 17:15:25 <span class="o">)</span>─&lt; <span class="nb">command </span>50 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># type person = {name:string;nickname:string;mutable age:int;};;</span>
<span class="nb">type </span>person <span class="o">=</span> <span class="o">{</span> name : string<span class="p">;</span> nickname : string<span class="p">;</span> mutable age : int<span class="p">;</span> <span class="o">}</span>
─<span class="o">(</span> 17:15:31 <span class="o">)</span>─&lt; <span class="nb">command </span>51 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let birthday p = p.age &lt;- p.age + 1;;</span>
val birthday : person -&gt; unit <span class="o">=</span> &lt;fun&gt;
─<span class="o">(</span> 17:21:54 <span class="o">)</span>─&lt; <span class="nb">command </span>52 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let vincent = {name = "vincent";nickname="embracer";age=20;};;</span>
val vincent : person <span class="o">=</span> <span class="o">{</span>name <span class="o">=</span> <span class="s2">"vincent"</span><span class="p">;</span> nickname <span class="o">=</span> <span class="s2">"embracer"</span><span class="p">;</span> age <span class="o">=</span> 20<span class="o">}</span>
─<span class="o">(</span> 17:22:50 <span class="o">)</span>─&lt; <span class="nb">command </span>54 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># birthday vincent;;</span>
- : unit <span class="o">=</span> <span class="o">()</span>
─<span class="o">(</span> 17:23:02 <span class="o">)</span>─&lt; <span class="nb">command </span>55 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># vincent;;</span>
- : person <span class="o">=</span> <span class="o">{</span>name <span class="o">=</span> <span class="s2">"vincent"</span><span class="p">;</span> nickname <span class="o">=</span> <span class="s2">"embracer"</span><span class="p">;</span> age <span class="o">=</span> 21<span class="o">}</span>
</pre></table></code></div></div><ul><li>数据类型具有多态性和递归性<li>多态性：数据类型可以引用其他的子类型<li>递归性：数据类型可以递归地引用自身</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 15:49:02 <span class="o">)</span>─&lt; <span class="nb">command </span>22 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># type 'a tree = | Leaf | Node of 'a tree * 'a * 'a tree;;</span>
<span class="nb">type</span> <span class="s1">'a tree = Leaf | Node of '</span>a tree <span class="k">*</span> <span class="s1">'a * '</span>a tree
─<span class="o">(</span> 15:49:02 <span class="o">)</span>─&lt; <span class="nb">command </span>23 <span class="o">&gt;</span>─────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let rec total t = match t with | Leaf -&gt; 0 | Node (l,x,r) -&gt; total l + x + total r;;</span>
val total : int tree -&gt; int <span class="o">=</span> &lt;fun&gt;
─<span class="o">(</span> 16:43:13 <span class="o">)</span>─&lt; <span class="nb">command </span>24 <span class="o">&gt;</span>─────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let rec reverse t = match t with | Leaf -&gt; Leaf | Node (l,x,r) -&gt; Node (reverse r, x, reverse l);;</span>
val reverse : <span class="s1">'a tree -&gt; '</span>a tree <span class="o">=</span> &lt;fun&gt;
─<span class="o">(</span> 16:45:16 <span class="o">)</span>─&lt; <span class="nb">command </span>25 <span class="o">&gt;</span>─────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let t = Node(Node(Leaf,1,Leaf),2,Node(Node(Leaf,3,Leaf),4,Node(Leaf,5,Leaf)));;</span>
val t : int tree <span class="o">=</span>
  Node <span class="o">(</span>Node <span class="o">(</span>Leaf, 1, Leaf<span class="o">)</span>, 2,
   Node <span class="o">(</span>Node <span class="o">(</span>Leaf, 3, Leaf<span class="o">)</span>, 4, Node <span class="o">(</span>Leaf, 5, Leaf<span class="o">)))</span>
─<span class="o">(</span> 16:48:00 <span class="o">)</span>─&lt; <span class="nb">command </span>26 <span class="o">&gt;</span>─────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let sum = total t;;</span>
val <span class="nb">sum</span> : int <span class="o">=</span> 15
─<span class="o">(</span> 16:51:09 <span class="o">)</span>─&lt; <span class="nb">command </span>27 <span class="o">&gt;</span>─────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let mirror = reverse t;;</span>
val mirror : int tree <span class="o">=</span>
  Node <span class="o">(</span>Node <span class="o">(</span>Node <span class="o">(</span>Leaf, 5, Leaf<span class="o">)</span>, 4, Node <span class="o">(</span>Leaf, 3, Leaf<span class="o">))</span>, 2,
   Node <span class="o">(</span>Leaf, 1, Leaf<span class="o">))</span>
─<span class="o">(</span> 16:51:24 <span class="o">)</span>─&lt; <span class="nb">command </span>28 <span class="o">&gt;</span>─────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let sum = total mirror;;</span>
val <span class="nb">sum</span> : int <span class="o">=</span> 15
─<span class="o">(</span> 16:51:59 <span class="o">)</span>─&lt; <span class="nb">command </span>29 <span class="o">&gt;</span>─────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># t = reverse mirror;;</span>
- : bool <span class="o">=</span> <span class="nb">true</span>
</pre></table></code></div></div><ul><li>错误处理<li>可以定义异常<code class="language-plaintext highlighter-rouge">exception</code>，同时为其添加子类型。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 16:56:53 <span class="o">)</span>─&lt; <span class="nb">command </span>32 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># exception E;;</span>
exception E
─<span class="o">(</span> 16:57:01 <span class="o">)</span>─&lt; <span class="nb">command </span>33 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># exception E1 of string;;</span>
exception E1 of string
─<span class="o">(</span> 16:57:33 <span class="o">)</span>─&lt; <span class="nb">command </span>35 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let divide a b = if b = 0 then raise (E1 "division by zero") else a / b;;</span>
val divide : int -&gt; int -&gt; int <span class="o">=</span> &lt;fun&gt;
─<span class="o">(</span> 16:59:27 <span class="o">)</span>─&lt; <span class="nb">command </span>37 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let result = try divide 1 0 with E1 _ -&gt; 0;;</span>
val result : int <span class="o">=</span> 0
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">option</code>类型，类似<code class="language-plaintext highlighter-rouge">Rust</code>。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 16:59:53 <span class="o">)</span>─&lt; <span class="nb">command </span>38 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># type 'a option = None | Some of 'a;;</span>
<span class="nb">type</span> <span class="s1">'a option = None | Some of '</span>a
─<span class="o">(</span> 17:00:06 <span class="o">)</span>─&lt; <span class="nb">command </span>39 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let list_find_option p l = match List.find p l with | v -&gt; Some(v) | exception Not_found -&gt; None;;</span>
val list_find_option : <span class="o">(</span><span class="s1">'a -&gt; bool) -&gt; '</span>a list -&gt; <span class="s1">'a option = &lt;fun&gt;
</span></pre></table></code></div></div><ul><li>可变引用。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 17:09:06 <span class="o">)</span>─&lt; <span class="nb">command </span>41 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let r = ref 50;;</span>
val r : int ref <span class="o">=</span> <span class="o">{</span>contents <span class="o">=</span> 50<span class="o">}</span>
─<span class="o">(</span> 17:10:58 <span class="o">)</span>─&lt; <span class="nb">command </span>42 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># r := 100;;</span>
- : unit <span class="o">=</span> <span class="o">()</span>
─<span class="o">(</span> 17:12:50 <span class="o">)</span>─&lt; <span class="nb">command </span>43 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># !r;;</span>
- : int <span class="o">=</span> 100
─<span class="o">(</span> 17:13:01 <span class="o">)</span>─&lt; <span class="nb">command </span>44 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let a = r;;</span>
val a : int ref <span class="o">=</span> <span class="o">{</span>contents <span class="o">=</span> 100<span class="o">}</span>
─<span class="o">(</span> 17:13:10 <span class="o">)</span>─&lt; <span class="nb">command </span>45 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># a := 100;;</span>
- : unit <span class="o">=</span> <span class="o">()</span>
─<span class="o">(</span> 17:13:16 <span class="o">)</span>─&lt; <span class="nb">command </span>46 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># !r;;</span>
- : int <span class="o">=</span> 100
</pre></table></code></div></div><ul><li>可变数组。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 17:13:27 <span class="o">)</span>─&lt; <span class="nb">command </span>47 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let arr = [|1;1;1|];;</span>
val arr : int array <span class="o">=</span> <span class="o">[</span>|1<span class="p">;</span> 1<span class="p">;</span> 1|]
─<span class="o">(</span> 17:13:35 <span class="o">)</span>─&lt; <span class="nb">command </span>48 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># arr.(0) &lt;- 100;;</span>
- : unit <span class="o">=</span> <span class="o">()</span>
─<span class="o">(</span> 17:15:13 <span class="o">)</span>─&lt; <span class="nb">command </span>49 <span class="o">&gt;</span>─────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># arr;;</span>
- : int array <span class="o">=</span> <span class="o">[</span>|100<span class="p">;</span> 1<span class="p">;</span> 1|]
</pre></table></code></div></div><ul><li>示例：列表求和函数。<li>Ocaml编译器会对模式匹配中忽略的情况发出警告。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 21:01:33 <span class="o">)</span>─&lt; <span class="nb">command </span>25 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let rec total l =</span>
match l with
| <span class="o">[]</span> -&gt; 0
| h :: t -&gt; h + total t<span class="p">;;</span>
val total : int list -&gt; int <span class="o">=</span> &lt;fun&gt;
─<span class="o">(</span> 21:01:37 <span class="o">)</span>─&lt; <span class="nb">command </span>26 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># total [1;2;3;4;5;6;7;8;9];;</span>
- : int <span class="o">=</span> 45
─<span class="o">(</span> 21:05:14 <span class="o">)</span>─&lt; <span class="nb">command </span>27 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let rec total l =</span>
match l with
| h :: t -&gt; h + total t<span class="p">;;</span>
Lines 2-3, characters 0-23:
Warning 8 <span class="o">[</span>partial-match]: this pattern-matching is not exhaustive.
Here is an example of a <span class="k">case</span> that is not matched:
<span class="o">[]</span>
val total : int list -&gt; int <span class="o">=</span> &lt;fun&gt;
</pre></table></code></div></div><ul><li>示例：映射函数。</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>─<span class="o">(</span> 21:05:31 <span class="o">)</span>─&lt; <span class="nb">command </span>28 <span class="o">&gt;</span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────<span class="o">{</span> counter: 0 <span class="o">}</span>─
utop <span class="c"># let rec map f l =</span>
match l with
| <span class="o">[]</span> -&gt; <span class="o">[]</span>
| h :: t -&gt; f h :: map f t<span class="p">;;</span>
val map : <span class="o">(</span><span class="s1">'a -&gt; '</span>b<span class="o">)</span> -&gt; <span class="s1">'a list -&gt; '</span>b list <span class="o">=</span> &lt;fun&gt;
</pre></table></code></div></div><ul><li>示例：快速排序(quicksort)算法。</ul><div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="k">rec</span> <span class="n">quicksort</span> <span class="o">=</span> <span class="k">function</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>  <span class="c">(* 空列表直接返回 *)</span>
  <span class="o">|</span> <span class="n">pivot</span> <span class="o">::</span> <span class="n">rest</span> <span class="o">-&gt;</span>
      <span class="k">let</span> <span class="k">rec</span> <span class="n">partition</span> <span class="n">left</span> <span class="n">right</span> <span class="o">=</span> <span class="k">function</span>
        <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">left</span><span class="o">,</span> <span class="n">right</span><span class="p">)</span>
        <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs</span> <span class="o">-&gt;</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">pivot</span> <span class="k">then</span> <span class="n">partition</span> <span class="p">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">left</span><span class="p">)</span> <span class="n">right</span> <span class="n">xs</span>
            <span class="k">else</span> <span class="n">partition</span> <span class="n">left</span> <span class="p">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">right</span><span class="p">)</span> <span class="n">xs</span>
      <span class="k">in</span>
      <span class="k">let</span> <span class="p">(</span><span class="n">left</span><span class="o">,</span> <span class="n">right</span><span class="p">)</span> <span class="o">=</span> <span class="n">partition</span> <span class="bp">[]</span> <span class="bp">[]</span> <span class="n">rest</span> <span class="k">in</span>
      <span class="n">quicksort</span> <span class="n">left</span> <span class="o">@</span> <span class="p">[</span><span class="n">pivot</span><span class="p">]</span> <span class="o">@</span> <span class="n">quicksort</span> <span class="n">right</span>
</pre></table></code></div></div><ul><li>示例：算式解释器。</ul><div class="language-ocaml highlighter-rouge"><div class="code-header"> <span data-label-text="Ocaml"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="k">type</span> <span class="n">expr</span> <span class="o">=</span>
  <span class="o">|</span> <span class="nc">Num</span> <span class="k">of</span> <span class="kt">int</span>
  <span class="o">|</span> <span class="nc">Add</span> <span class="k">of</span> <span class="n">expr</span> <span class="o">*</span> <span class="n">expr</span>
  <span class="o">|</span> <span class="nc">Sub</span> <span class="k">of</span> <span class="n">expr</span> <span class="o">*</span> <span class="n">expr</span>

<span class="k">let</span> <span class="k">rec</span> <span class="n">eval</span> <span class="o">=</span> <span class="k">function</span>
  <span class="o">|</span> <span class="nc">Num</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span>
  <span class="o">|</span> <span class="nc">Add</span> <span class="p">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">eval</span> <span class="n">e1</span> <span class="o">+</span> <span class="n">eval</span> <span class="n">e2</span>
  <span class="o">|</span> <span class="nc">Sub</span> <span class="p">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">eval</span> <span class="n">e1</span> <span class="o">-</span> <span class="n">eval</span> <span class="n">e2</span>

<span class="k">let</span> <span class="n">example</span> <span class="o">=</span> <span class="nc">Add</span> <span class="p">(</span><span class="nc">Num</span> <span class="mi">5</span><span class="o">,</span> <span class="nc">Sub</span> <span class="p">(</span><span class="nc">Num</span> <span class="mi">10</span><span class="o">,</span> <span class="nc">Num</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">let</span> <span class="n">result</span> <span class="o">=</span> <span class="n">eval</span> <span class="n">example</span> <span class="c">(* the result is 12 *)</span>
</pre></table></code></div></div><h2 id="ocaml的应用场景"><span class="mr-2">OCaml的应用场景</span><a href="#ocaml的应用场景" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">OCaml</code>在多个领域有广泛应用，尤其在对类型安全和性能要求高的场景：</p><h3 id="学术研究"><span class="mr-2">学术研究</span><a href="#学术研究" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>形式化验证：<code class="language-plaintext highlighter-rouge">OCaml</code> 是 <code class="language-plaintext highlighter-rouge">Coq</code> 定理证明器的实现语言，用于开发形式化验证工具。<li>编程语言研究：<code class="language-plaintext highlighter-rouge">OCaml</code> 的类型系统和模块系统使其成为编译器和解释器开发的理想选择。</ul><h3 id="工业应用"><span class="mr-2">工业应用</span><a href="#工业应用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>金融系统：如 <code class="language-plaintext highlighter-rouge">Jane Street</code> 广泛使用 <code class="language-plaintext highlighter-rouge">OCaml</code> 开发高性能交易系统，因其类型安全和低延迟。<li>静态分析工具：如 <code class="language-plaintext highlighter-rouge">Facebook</code> 的 <code class="language-plaintext highlighter-rouge">Flow</code>(<code class="language-plaintext highlighter-rouge">JavaScript</code> 静态类型检查器)和 <code class="language-plaintext highlighter-rouge">Infer</code>(代码分析工具)用 <code class="language-plaintext highlighter-rouge">OCaml</code> 实现。<li>区块链：<code class="language-plaintext highlighter-rouge">Tezos</code> 区块链的协议实现大量使用 <code class="language-plaintext highlighter-rouge">OCaml</code>。</ul><h3 id="系统编程"><span class="mr-2">系统编程</span><a href="#系统编程" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>MirageOS：一个用 <code class="language-plaintext highlighter-rouge">OCaml</code> 编写的轻量级 <code class="language-plaintext highlighter-rouge">Unikernel</code> 系统，用于构建高效、安全的操作系统。<li>编译器与工具：<code class="language-plaintext highlighter-rouge">OCaml</code> 自身编译器、<code class="language-plaintext highlighter-rouge">FFmpeg</code> 的部分组件等都用 <code class="language-plaintext highlighter-rouge">OCaml</code> 编写。</ul><h2 id="ocaml学习资源"><span class="mr-2">OCaml学习资源</span><a href="#ocaml学习资源" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>官方文档：<a href="https://ocaml.org/">OCaml 官方网站</a>提供教程和参考手册。<li>书籍：<ul><li>《Real World OCaml》：面向实际应用的 <code class="language-plaintext highlighter-rouge">OCaml</code> 教程。<li>《OCaml from the Very Beginning》：适合初学者。</ul><li>工具：<ul><li><code class="language-plaintext highlighter-rouge">opam</code>：安装 <code class="language-plaintext highlighter-rouge">OCaml</code> 和管理依赖。<li><code class="language-plaintext highlighter-rouge">dune</code>：现代构建工具。<li><code class="language-plaintext highlighter-rouge">utop</code>：交互式 <code class="language-plaintext highlighter-rouge">REPL</code>，适合学习和实验。</ul><li>社区：<code class="language-plaintext highlighter-rouge">OCaml Discourse</code>、<code class="language-plaintext highlighter-rouge">Reddit</code> 和 <code class="language-plaintext highlighter-rouge">Stack Overflow</code> 上的 <code class="language-plaintext highlighter-rouge">OCaml</code> 标签。</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/vincent-s-technical-reports/'>Vincent's Technical Reports</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ocaml/" class="post-tag no-text-decoration" >Ocaml</a> <a href="/tags/programming-language/" class="post-tag no-text-decoration" >Programming Language</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Ocaml(1)%20%7C%20Vincent's%20Technical%20Reports%20(Vol.%202)%20-%20%E5%AE%8B%E5%BB%BA%E6%98%8A&url=https%3A%2F%2Fvincent-sjh.github.io%2Fhomepage%2Findex.html%2Fposts%2FOcaml-1%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Ocaml(1)%20%7C%20Vincent's%20Technical%20Reports%20(Vol.%202)%20-%20%E5%AE%8B%E5%BB%BA%E6%98%8A&u=https%3A%2F%2Fvincent-sjh.github.io%2Fhomepage%2Findex.html%2Fposts%2FOcaml-1%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fvincent-sjh.github.io%2Fhomepage%2Findex.html%2Fposts%2FOcaml-1%2F&text=Ocaml(1)%20%7C%20Vincent's%20Technical%20Reports%20(Vol.%202)%20-%20%E5%AE%8B%E5%BB%BA%E6%98%8A" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" data-title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/AI-IDE/">Productivity Tool Recommendations | Workflow Wizards (Vol. 1)</a><li><a href="/posts/Web-Page/">How can we see a web page? | Vincent's Technical Reports (Vol. 5)</a><li><a href="/posts/RSA-SSH/">RSA & SSH | Vincent's Technical Reports (Vol. 3)</a><li><a href="/posts/AI-Detector-Humanizer/">AI Detector & Humanizer | Vincent's Technical Reports (Vol. 4)</a><li><a href="/posts/Reverse_Engineering/">A Try on Reverse Engineering | Vincent's Technical Reports (Vol. 1)</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/llm/">LLM</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/decompiler/">Decompiler</a> <a class="post-tag" href="/tags/detector/">Detector</a> <a class="post-tag" href="/tags/hello-world/">Hello World</a> <a class="post-tag" href="/tags/humanizer/">Humanizer</a> <a class="post-tag" href="/tags/number-theory/">Number Theory</a> <a class="post-tag" href="/tags/ocaml/">Ocaml</a> <a class="post-tag" href="/tags/programming-language/">Programming Language</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Reverse_Engineering/"><div class="card-body"> <em class="small" data-ts="1748363400" data-df="YYYY/MM/DD" > 2025/05/27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>A Try on Reverse Engineering | Vincent's Technical Reports (Vol. 1)</h3><div class="text-muted small"><p> 一次有趣的逆向工程经历 前因 在五道口技术学院某抽象院系的某课程的一次作业中，出现了有趣的情况。 作业要求监测某可执行文件运行过程中的数据，再用数据推测得到助教提前设置好的两个信息。 提供给同学们下载的是编译好的可执行文件，而不是源代码，不然可以直接阅读源码获得答案。 同时，这个可执行文件运行需要一个参数，助教规定每个同学将参数设置为自己的学号。 这是为了保证同学们的答案不全相同...</p></div></div></a></div><div class="card"> <a href="/posts/RSA-SSH/"><div class="card-body"> <em class="small" data-ts="1753547400" data-df="YYYY/MM/DD" > 2025/07/26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RSA & SSH | Vincent's Technical Reports (Vol. 3)</h3><div class="text-muted small"><p> RSA and SSH RSA加密算法详解 简介 RSA加密算法是1977年由Ron Rivest、Adi Shamir和Leonard Adleman共同提出的一种非对称加密算法，算法名称取自三位发明者姓氏的首字母。RSA是目前应用最广泛的公钥密码体制，广泛用于数字签名、密钥交换和数据加密等领域。 非对称加密是指加密者与解密者使用的是不同的密钥，反之对称加密是指加密者和解密者使用相同的...</p></div></div></a></div><div class="card"> <a href="/posts/AI-Detector-Humanizer/"><div class="card-body"> <em class="small" data-ts="1754929800" data-df="YYYY/MM/DD" > 2025/08/11 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AI Detector & Humanizer | Vincent's Technical Reports (Vol. 4)</h3><div class="text-muted small"><p> AI Detector V.S. Humanizer 简介 人工智能时代，人们越来越多地使用AI工具完成任务，当AI生成的内容越来越多时，AI检测工具和AI降重工具便应运而生。本次实验希望粗略地测试当前AI检查工具和AI降重工具的效果，选取了当前8个AI降重工具和3个AI检测工具，首先使用当前5款主流大模型生成风格和主题不同的英文文本，比较AI降重后的AI重复率，有趣的是，我还额外从新闻...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Reverse_Engineering/" class="btn btn-outline-primary" prompt="上一篇"><p>A Try on Reverse Engineering | Vincent's Technical Reports (Vol. 1)</p></a> <a href="/posts/AI-IDE/" class="btn btn-outline-primary" prompt="下一篇"><p>Productivity Tool Recommendations | Workflow Wizards (Vol. 1)</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/llm/">LLM</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/decompiler/">Decompiler</a> <a class="post-tag" href="/tags/detector/">Detector</a> <a class="post-tag" href="/tags/hello-world/">Hello World</a> <a class="post-tag" href="/tags/humanizer/">Humanizer</a> <a class="post-tag" href="/tags/number-theory/">Number Theory</a> <a class="post-tag" href="/tags/ocaml/">Ocaml</a> <a class="post-tag" href="/tags/programming-language/">Programming Language</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/si57311">Vincent</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0">本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> (function () { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE ? "dark" : "default"); let config = {theme: expectedTheme}; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function () { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Create mermaid tag */ $("pre").has("code.language-mermaid").each(function () { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<pre class=\"mermaid\">${svgCode}</pre>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); })(); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/zh.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
